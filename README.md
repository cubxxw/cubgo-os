# cubgo-os
[![FOSSA Status](https://app.fossa.com/api/projects/git%2Bgithub.com%2F3293172751%2Fcubgo-os.svg?type=shield)](https://app.fossa.com/projects/git%2Bgithub.com%2F3293172751%2Fcubgo-os?ref=badge_shield)


<a href="https://trackgit.com">
<img src="https://us-central1-trackgit-analytics.cloudfunctions.net/token/ping/la3dnjvnm2bzv9eg5ola" alt="trackgit-views" />
</a>

## ç›®å½•

<details>
<summary>ğŸ“‡ ç›®å½•æŠ˜å </summary>
<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
**Table of Contents**

- [èƒŒæ™¯](#%E8%83%8C%E6%99%AF)
  - [eggosæ“ä½œç³»ç»Ÿ](#eggos%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F)
  - [Biscuitæ“ä½œç³»ç»Ÿ](#biscuit%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F)
  - [mit åœ°é¼ æ“ä½œç³»ç»Ÿ](#mit-%E5%9C%B0%E9%BC%A0%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F)
- [åˆ†æ](#%E5%88%86%E6%9E%90)
- [ç±»ä¼¼é¡¹ç›®](#%E7%B1%BB%E4%BC%BC%E9%A1%B9%E7%9B%AE)
- [å¹¶è¡Œæˆ–åˆ†å¸ƒå¼ç®—æ³•](#%E5%B9%B6%E8%A1%8C%E6%88%96%E5%88%86%E5%B8%83%E5%BC%8F%E7%AE%97%E6%B3%95)
  - [è¯¾ç¨‹ç®€ä»‹](#%E8%AF%BE%E7%A8%8B%E7%AE%80%E4%BB%8B)
  - [è¯¾ç¨‹èµ„æº](#%E8%AF%BE%E7%A8%8B%E8%B5%84%E6%BA%90)
  - [èµ„æºæ±‡æ€»](#%E8%B5%84%E6%BA%90%E6%B1%87%E6%80%BB)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->
<!-- START doctoc -->
</details>

âš¡cubgo-osï¼ˆå¹¼å…½æ“ä½œç³»ç»Ÿï¼‰ç”±Goè¯­è¨€å¼€å‘ï¼Œå¯ä»¥è¿è¡ŒåŸºç¡€åº”ç”¨~

> [å…³äºæ“ä½œç³»ç»Ÿçš„å­¦ä¹ ](https://github.com/3293172751/os)

+ [x] [eggosæ–‡æ¡£](docs/eggos.md)



## èƒŒæ™¯

å—æ¸…åçš„`rcore`é¡¹ç›®å½±å“

> [ä½ ç®¡è¿™ç ´ç©æ„å«æ“ä½œç³»ç»Ÿæºç  â€” åƒå°è¯´ä¸€æ ·å“è¯» Linux 0.11 æ ¸å¿ƒä»£ç ](https://github.com/sunym1993/flash-linux0.11-talk)



### eggosæ“ä½œç³»ç»Ÿ

+ [åœ¨ x86 è£¸æœºä¸Šè¿è¡Œçš„ Go unikernel](https://github.com/icexin/eggos)  ==> [æ–‡æ¡£](https://eggos.icexin.com/)

> ä½¿ç”¨`Go`è¯­è¨€ç¼–å†™çš„è¿è¡Œåœ¨`x86`è£¸æœºä¸Šçš„`unikernel`
>
> å°†`Go`ç¨‹åºè¿è¡Œåœ¨`x86`è£¸æœºä¸Šï¼Œå…¨éƒ¨ä½¿ç”¨`Go`è¯­è¨€ç¼–å†™(`bootloader`é‡Œé¢æœ‰å°‘é‡æ±‡ç¼–å’Œc)ï¼Œæ”¯æŒå¤§éƒ¨åˆ†`Go`çš„æ ¸å¿ƒåŠŸèƒ½(`GC`ï¼Œ`goroutine`ç­‰)ï¼ŒåŒ…æ‹¬å¤§éƒ¨åˆ†`Go`çš„æ ‡å‡†åº“ï¼ŒåŒæ—¶ä¹Ÿé™„å¸¦ä¸€ä¸ªç½‘ç»œåè®®æ ˆï¼Œä»è€Œèƒ½è¿è¡Œå¤§éƒ¨åˆ†åŸºäº`net`åº“çš„ç¬¬ä¸‰æ–¹åº“ã€‚
>
> ä¸åŒäºä¼ ç»Ÿçš„æ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œ`eggos`æ²¡æœ‰å¯¹ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„ä»£ç è¿›è¡Œéš”ç¦»ï¼Œæ•´ä¸ª`unikernel`è¿è¡Œåœ¨ä¸€ä¸ªåœ°å€ç©ºé—´ä¸Šã€‚æ²¡æœ‰è¿›ç¨‹çš„æ¦‚å¿µä»¥åŠè¿›ç¨‹é—´é€šä¿¡ï¼Œä½†æ˜¯å®Œæ•´æ”¯æŒäº†`Go`çš„`goroutine`å’Œ`channel`ã€‚å¦å¤–ä¹Ÿæ²¡æœ‰ä¼ ç»Ÿçš„`ELF`åŠ è½½å™¨ï¼Œä½†æ˜¯é™„å¸¦äº†ä¸€ä¸ª`Javascript`çš„è§£é‡Šå™¨ã€‚



### Biscuitæ“ä½œç³»ç»Ÿ

+ [Biscuit æ“ä½œç³»ç»Ÿ](https://github.com/mit-pdos/biscuit)

`Biscuit` æ˜¯ç”¨äº `x86-64 CPU` çš„ Go ä¸­çš„å•ç‰‡ `POSIX` å­é›†æ“ä½œç³»ç»Ÿå†…æ ¸ã€‚ç¼–å†™å®ƒæ˜¯ä¸ºäº†ç ”ç©¶ä½¿ç”¨å¸¦æœ‰åƒåœ¾æ”¶é›†çš„é«˜çº§è¯­è¨€æ¥å®ç°å…·æœ‰é€šç”¨æ¶æ„é£æ ¼çš„å†…æ ¸çš„æ€§èƒ½æƒè¡¡ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å…³äº Biscuit çš„ç ”ç©¶è®ºæ–‡ï¼š [https ://pdos.csail.mit.edu/projects/biscuit.html](https://pdos.csail.mit.edu/projects/biscuit.html)

`Biscuit` å…·æœ‰ä¸€äº›é‡è¦ç‰¹æ€§ï¼Œå¯ç”¨äºè·å¾—è‰¯å¥½çš„åº”ç”¨ç¨‹åºæ€§èƒ½ï¼š

+ å¤šæ ¸
+ å†…æ ¸æ”¯æŒçš„çº¿ç¨‹
+ å…·æœ‰å¹¶å‘ã€å»¶è¿Ÿå’Œç»„æäº¤çš„æ—¥å¿—å¼ `FS`
+ ç”¨äºå†™å…¥æ—¶å¤åˆ¶å’Œå»¶è¿Ÿæ˜ å°„çš„åŒ¿å/æ–‡ä»¶é¡µé¢çš„è™šæ‹Ÿå†…å­˜
+ `TCP/IP` å †æ ˆ
+ `AHCI SATA` ç£ç›˜é©±åŠ¨ç¨‹åº
+ è‹±ç‰¹å°” 10Gb ç½‘å¡é©±åŠ¨ç¨‹åº

`Biscuit` è¿˜åŒ…æ‹¬ä¸€ä¸ªå¼•å¯¼åŠ è½½ç¨‹åºã€ä¸€ä¸ªéƒ¨åˆ† libcï¼ˆâ€œlitcâ€ï¼‰å’Œä¸€äº›ç”¨æˆ·ç©ºé—´ç¨‹åºï¼Œå°½ç®¡æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `GRUB` æˆ–ç°æœ‰çš„ `libc` å®ç°ï¼Œå¦‚ `musl`ã€‚

è¿™ä¸ª `repo` æ˜¯ `Go repo` ( https://github.com/golang/go ) çš„ä¸€ä¸ªåˆ†æ”¯ã€‚å‡ ä¹æ‰€æœ‰ Biscuit çš„ä»£ç éƒ½åœ¨ biscuit/ ä¸­ã€‚



**åŠŸèƒ½åˆ—è¡¨**

+ Goçš„å†…ç½®åŠŸèƒ½ï¼Œå¦‚GCï¼Œgoroutineï¼Œchannelç­‰
+ ä¸€ä¸ªæ”¯æŒè¡Œç¼–è¾‘çš„ç»ˆç«¯
+ æ”¯æŒTCP/IPçš„åè®®æ ˆ
+ Goé£æ ¼çš„VFSæŠ½è±¡ï¼Œä½¿ç”¨[afero](https://github.com/spf13/afero)
+ NESæ¨¡æ‹Ÿå™¨ï¼Œä½¿ç”¨[nes](https://github.com/fogleman/nes)
+ Javascriptè§£é‡Šå™¨ï¼Œä½¿ç”¨[otto](https://github.com/robertkrimen/otto)
+ GUIæ”¯æŒï¼Œä½¿ç”¨[nucular](https://github.com/aarzilli/nucular)
+ ä¸€äº›ç®€å•çš„åº”ç”¨ï¼Œå¦‚(httpd, sshd)



### mit åœ°é¼ æ“ä½œç³»ç»Ÿ

+ [mit åœ°é¼ æ“ä½œç³»ç»Ÿ](https://github.com/gopher-os/gopher-os)  ==> [å®˜ç½‘](https://pdos.csail.mit.edu/projects/biscuit.html)

è¯¥é¡¹ç›®çš„ç›®æ ‡æ˜¯ä½¿ç”¨[Go](https://golang.org/)æ„å»ºä¸€ä¸ª 64 ä½ POSIX å…¼å®¹çš„æ— æ»´ç­”å†…æ ¸ï¼Œå¹¶ä½¿ç”¨ä¸ Linux å…¼å®¹çš„ç³»ç»Ÿè°ƒç”¨å®ç°ã€‚

è¿™ä¸ªé¡¹ç›®ä¸æ˜¯è¦æ„å»ºå¦ä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼Œè€Œæ˜¯ä¸ºäº†è¯æ˜ Go ç¡®å®æ˜¯ç¼–å†™åœ¨ ring-0 è¿è¡Œçš„ä½çº§ä»£ç çš„åˆé€‚å·¥å…·ã€‚

> **æ³¨æ„**ï¼šè¯¥é¡¹ç›®ä»å¤„äºæ—©æœŸå¼€å‘é˜¶æ®µï¼Œå°šæœªå¤„äºå¯ç”¨çŠ¶æ€ã€‚äº‹å®ä¸Šï¼Œå¦‚æœä½ æ„å»º ISO å¹¶å¯åŠ¨å®ƒï¼Œå†…æ ¸æœ€ç»ˆä¼šå› ä¸º`Kmain returned`é”™è¯¯è€Œææ…Œã€‚
>
> è¦äº†è§£æœ‰å…³å½“å‰é¡¹ç›®çŠ¶æ€å’ŒåŠŸèƒ½è·¯çº¿å›¾çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹[çŠ¶æ€](https://github.com/gopher-os/gopher-os/blob/master/STATUS.md)é¡µé¢ã€‚



## åˆ†æ

Goè¯­è¨€ç¼–å†™æ“ä½œç³»ç»Ÿå†…æ ¸ä¸€ç›´æ˜¯ä¸€ä¸ªå†·é—¨çš„é¢†åŸŸï¼Œéš¾ä»¥æƒ³ä¸€ä¸ªå¸¦runtimeçš„è¯­è¨€å¦‚ä½•åœ¨æ²¡æœ‰æ“ä½œç³»ç»Ÿçš„è£¸æœºä¸Šå¯åŠ¨è¿è¡Œï¼Œè®©è¯­è¨€è‡ªå·±çš„åŠŸèƒ½èƒ½æ­£å¸¸è¿è¡Œéƒ½éš¾ï¼Œæ›´åˆ«è¯´åšæ“ä½œç³»ç»Ÿå¸¸è§çš„å†…å­˜ç®¡ç†ï¼Œè¿›ç¨‹ç®¡ç†ç­‰ã€‚ä½†ä¹Ÿæœ‰äººä¸æ–­åœ°å°è¯•ï¼Œæ¯”å¦‚ä»¥ä¸‹å‡ ä¸ªé¡¹ç›®ï¼š

**1.tinny**

[https://github.com/golang/go/commit/434f1e32a075d546f47943598aa5974d4a2492cegithub.com/golang/go/commit/434f1e32a075d546f47943598aa5974d4a2492ce](https://link.zhihu.com/?target=https%3A//github.com/golang/go/commit/434f1e32a075d546f47943598aa5974d4a2492ce)

è¿™ä¸ªæ˜¯Goå®˜æ–¹çš„æ—©æœŸç‰ˆæœ¬çš„ä¸€ä¸ªå®ç°ï¼Œèƒ½è·‘concurrent prime sieveï¼Œç°åœ¨å·²ç»åˆ æ‰äº†ï¼Œå¯ä»¥çœ‹åˆ°åœ¨Goæ—©æœŸç‰ˆæœ¬é‡Œé¢runtimeè¿˜æ²¡æœ‰é‚£ä¹ˆå¤æ‚çš„æ—¶å€™ï¼Œç§»æ¤åˆ°è£¸æœºå…¶å®æŒºç®€å•çš„ï¼Œæƒ³è€ƒå¤çš„åŒå­¦å¯ä»¥è¯•ä¸€ä¸‹ï¼Œé‡Œé¢ç”¨åˆ°çš„bootloaderæ˜¯è‘—åçš„[xv6](https://link.zhihu.com/?target=https%3A//github.com/mit-pdos/xv6-public)çš„å®ç°ï¼Œå› ä¸ºRuss Coxè‡ªå·±å°±æ˜¯xv6çš„ä½œè€…ä¹‹ä¸€ã€‚



**2.gopher-os**

[https://github.com/gopher-os/gopher-osgithub.com/gopher-os/gopher-os](https://link.zhihu.com/?target=https%3A//github.com/gopher-os/gopher-os)

è¿™ä¸ªé€šè¿‡ä¿®æ”¹goçš„ç¼–è¯‘è¿‡ç¨‹ä»¥åŠé‡å®šå‘runtimeç¬¦å·å®ç°äº†ä¸€ä¸ªæ¦‚å¿µå†…æ ¸ï¼Œé¡¹ç›®æœ¬è¯æ˜äº†goèƒ½è„±ç¦»æ“ä½œç³»ç»Ÿè¿è¡Œåœ¨è£¸æœºä¸Šï¼Œæœ€ç»ˆçš„æ•ˆæœæ˜¯åœ¨å›¾å½¢åŒ–ç»ˆç«¯ä¸Šæ‰“å°äº†ä¸€ä¸‹ç¡¬ä»¶ä¿¡æ¯ï¼Œæ²¡æœ‰è¿‡å¤šçš„å…¶ä»–åº”ç”¨ã€‚



**3.biscuit**

è¿™æ˜¯ä¸€ä¸ªåšå£«è®ºæ–‡é¡¹ç›®ï¼Œå®Œæˆåº¦å¾ˆé«˜ï¼Œå¤šæ ¸ï¼Œå¤šçº¿ç¨‹ï¼Œç½‘ç»œåè®®æ ˆç­‰ç­‰ã€‚è¿™ä¸ªé¡¹ç›®æ˜¯å¥”ç€å†™ä¸€ä¸ªæ“ä½œç³»ç»Ÿå†…æ ¸å»çš„ï¼Œå…¶å…¼å®¹äº†ä¸€äº›POSIXæ¥å£ï¼Œæ ¹æ®è®ºæ–‡é‡Œé¢çš„å†…å®¹ï¼Œå¯ä»¥è·‘rediså’Œnginxã€‚å®ç°æ–¹å¼æ˜¯hackäº†linuxçš„amd64 archç›¸å…³ä»£ç ï¼Œæ³¨å…¥äº†è‡ªå·±çš„å®ç°ï¼Œä»£ç æ•´ä½“åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†å­˜åœ¨äºgoçš„æ ‡å‡†åº“é‡Œé¢çš„runtimeç›®å½•ä¸‹ï¼Œä¸€éƒ¨åˆ†æ˜¯åœ¨é¡¹ç›®çš„biscuitç›®å½•ä¸‹ã€‚

æˆ‘æœ€æ—©çš„æƒ³æ³•ä¹Ÿæ˜¯å€Ÿé‰´è¿™ä¸ªé¡¹ç›®ï¼Œä¸è¿‡ä¸æ˜¯hack runtimeçš„æŸä¸ªarchå’Œosï¼Œè€Œæ˜¯æ–°é€ äº†ä¸€ä¸ªGOOS=eggosï¼Œç¼–è¯‘çš„æ—¶å€™æŒ‡å®šè¿™ä¸ªGOOSç¯å¢ƒå˜é‡å°±èƒ½ç”Ÿæˆç›¸åº”çš„å†…æ ¸ï¼Œä¸è¿‡ä¸ºäº†èƒ½è®©å·¥å…·é“¾å’Œæ ‡å‡†åº“èƒ½ç¼–è¯‘é€šè¿‡ï¼Œä¿®æ”¹äº†å¾ˆå¤šæ ‡å‡†åº“ä»£ç ï¼Œå¤§éƒ¨åˆ†åªæ˜¯åŠ äº†ä¸€ä¸ªç¼–è¯‘tagï¼Œæ¯”å¦‚è¿™ä¸ªæ–‡ä»¶çš„è¿™è¡Œä»£ç ï¼Œå°±éœ€è¦åœ¨å¼€å¤´åŠ ä¸Šæˆ‘è‡ªå·±çš„æ“ä½œç³»ç»Ÿåç§°ï¼Œç±»ä¼¼è¿™æ ·çš„æ–‡ä»¶å¾ˆå¤šï¼Œè¿™æ ·åšå…¶å®æ˜¯ä¸åˆ©äºè·Ÿè¿›goçš„ç‰ˆæœ¬å‡çº§çš„ã€‚



**4.unik**

[~eliasnaur/unik - sourcehut gitgit.sr.ht/~eliasnaur/unik](https://link.zhihu.com/?target=https%3A//git.sr.ht/~eliasnaur/unik)

è¿™ä¸ªé¡¹ç›®æ˜¯æˆ‘åœ¨æ‰¾Goå®ç°çš„å¹³å°æ— å…³çš„GUIé¡¹ç›®æ—¶å‘ç°çš„ï¼Œä½œè€…å†™äº†ä¸€ä¸ªGoçš„GUIé¡¹ç›®ï¼ŒåŒæ—¶ä¸ºäº†è¯æ˜å…¶è·¨å¹³å°èƒ½åŠ›ç”¨Goå†™äº†ä¸€ä¸ªè¿è¡Œäºè£¸æœºçš„åº”ç”¨ç¨‹åºï¼Œæ˜¾å¡é©±åŠ¨ä½¿ç”¨äº†virtioã€‚ä½œè€…è¿˜æ˜¯æŒºç‰›çš„ã€‚æˆ‘åæ¥åˆæ·±æŒ–äº†ä¸€ä¸‹ï¼Œå‘ç°ä»–ä¹‹å‰å°±åœ¨Goçš„issueæè¿‡æƒ³è®©å®˜æ–¹æä¾›ä¸€ä¸ªGOOS=noneçš„å®ç°ï¼Œissueé‡Œçš„å¾ˆå¤šèµ„æ–™è¿˜æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œå…·ä½“è®¨è®ºè§è¿™é‡Œ

[https://github.com/golang/go/issues/35956github.com/golang/go/issues/35956](https://link.zhihu.com/?target=https%3A//github.com/golang/go/issues/35956)

è¿™ä¸ªé¡¹ç›®å¯¹Go runtimeçš„å¯åŠ¨æ–¹å¼å¯¹æˆ‘å¯å‘å¾ˆå¤§ï¼Œåœ¨çœ‹åˆ°è¿™ä¸ªé¡¹ç›®åï¼Œæˆ‘æŠŠæˆ‘ä¹‹å‰çš„å®ç°æ”¹æˆç±»ä¼¼çš„æ–¹å¼ï¼Œä¹‹åå°±æ‘†è„±äº†å¯¹Go runtimeä»£ç åº“çš„ä¾èµ–ã€‚

æ€»ç»“ä¸€ä¸‹å‡ ç§å®ç°è£¸æœºä¸Šè¿è¡ŒGoçš„æ–¹å¼ï¼š

1. ç›´æ¥åŠ ä¸€ä¸ªæ–°çš„GOOSï¼ŒGOARCHçœ‹è‡ªå·±è¦å®ç°çš„å¹³å°ï¼Œè¿™ç§æ–¹å¼éœ€è¦ä¿®æ”¹runtimeï¼Œç¼–è¯‘å™¨ä»¥åŠæ ‡å‡†åº“çš„ä»£ç ï¼Œä¼˜ç‚¹æ˜¯å®ç°æ¯”è¾ƒç›´æ¥ï¼Œå¹¶ä¸”å¯ä»¥åšä¸€äº›å®šåˆ¶ï¼Œæƒ³æ›´æ”¹runtimeè¡Œä¸ºçš„æ—¶å€™ä»£ç ä¸ç»•å¼¯ï¼Œç¼ºç‚¹æ˜¯ä¸ç‰¹å®šGoç‰ˆæœ¬çš„ä»£ç ç»‘å®šï¼Œä¸åˆ©äºåç»­å‡çº§ã€‚
2. é­”æ”¹Goçš„ç¼–è¯‘é“¾æ¥è¿‡ç¨‹ï¼Œå°†runtimeé‡Œé¢çš„osç›¸å…³å®ç°é“¾æ¥åˆ°è‡ªå·±çš„å®ç°ä¸Šï¼Œæœ¬è´¨ä¸Šè·Ÿç¬¬ä¸€ç§æ–¹æ¡ˆç±»ä¼¼ï¼Œä½†æ²¡æœ‰ä¿®æ”¹runtimeä»£ç ï¼Œç¼ºç‚¹æ˜¯Makefileå¤ªå¤æ‚ï¼Œå¹¶ä¸”å¾ˆä¾èµ–ç‰¹å®šç‰ˆæœ¬çš„ç¼–è¯‘å™¨ã€‚
3. æ›´æ”¹æœ€ç»ˆç”Ÿæˆçš„ELFç¨‹åºçš„å…¥å£ï¼Œå¼•å¯¼åˆ°è‡ªå·±å®ç°çš„åˆå§‹åŒ–ä»£ç ï¼Œæœ€åå†è·³è½¬åˆ°Goçš„runtimeå…¥å£ã€‚è¿™ç§æ–¹æ¡ˆæ˜¯ç›®å‰æˆ‘è§‰å¾—æœ€ç®€æ´çš„æ–¹å¼ï¼Œå³ä¸ç”¨ä¿®æ”¹runtimeä»£ç ï¼Œåˆç”¨çš„æ˜¯æ ‡å‡†å·¥å…·çš„èƒ½åŠ›ï¼Œä¹‹åå…¼å®¹æ›´é«˜çš„Goç‰ˆæœ¬ä¹Ÿä¸ä¼šæœ‰å¤§æ”¹ã€‚

å½“ç„¶è®©Goç¨‹åºåœ¨è£¸æœºä¸Šè·‘èµ·æ¥è¿œä¸æ­¢ä¸Šé¢è¯´çš„é‚£äº›ï¼Œä¸Šé¢è¯´çš„åªæ˜¯è§£å†³äº†runtimeçš„bootstrapçš„é—®é¢˜ï¼Œä½†è®©Goç¨‹åºä½¿ç”¨åŸºæœ¬çš„new, interfaceï¼Œgoroutineï¼Œchannelç­‰ï¼Œæˆ‘ä»¬è‡³å°‘è¿˜è¦è§£å†³ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š

1. **å†…å­˜**ï¼Œ Goæ˜¯ä¸€ä¸ªå¸¦å†…å­˜ç®¡ç†çš„è¯­è¨€ï¼Œå†…å­˜é—®é¢˜æ˜¯æˆ‘ä»¬é¦–è¦è§£å†³çš„ï¼Œä¸ç„¶å°±å›åˆ°æ‰‹å·¥ç®¡ç†å†…å­˜çš„æ—¶ä»£ã€‚å¥½æ¶ˆæ¯æ˜¯Goçš„runtimeå¯¹OSçš„å†…å­˜æ¥å£ä¾èµ–å¾ˆæŒºç®€å•ï¼Œä¸»è¦æœ‰sysAllocï¼ŒsysReserveï¼ŒsysMapç­‰ï¼Œå¦‚æœé‡‡ç”¨ç¬¬ä¸€ç§æ–¹å¼å®ç°å†…æ ¸ï¼Œå¯ä»¥å‚è€ƒwasm(runtime/mem_js.go)çš„å®ç°ï¼Œç”±äºwasmæ•´ä¸ªæ˜¯ä¸€ä¸ªçº¿æ€§å†…å­˜ï¼Œè·Ÿè£¸æœºçš„å†…å­˜æ¨¡å‹ä¸€è‡´ï¼Œå› æ­¤å¾ˆæœ‰å‚è€ƒæ€§ã€‚å¦‚æœæ˜¯åé¢å‡ ç§å®ç°ï¼Œå°±è¦æ¨¡æ‹Ÿlinuxçš„mmapç³»ç»Ÿè°ƒç”¨ï¼Œè¿™ä¸ªåé¢å†è¯´ã€‚
2. **çº¿ç¨‹ï¼Œ** çº¿ç¨‹å¯¹åº”Go GMPæ¨¡å‹é‡Œé¢çš„Mï¼Œç”¨äºæ‰§è¡ŒæŸä¸ªGoroutineçš„ä»£ç ã€‚å¦‚æœæ˜¯ç¬¬ä¸€ç§å®ç°ï¼Œå¯ä»¥å‚è€ƒ**wasm**åœ¨**runtime**é‡Œé¢çš„ä»£ç ï¼Œwasmæ˜¯å•çº¿ç¨‹å®ç°ï¼Œå› æ­¤ä¸ç”¨è€ƒè™‘å¤šä¸ªMçš„æƒ…å†µï¼Œç»“æœæ˜¯**wasm**é‡Œé¢æ²¡æœ‰å¯åŠ¨**sysmon**åç¨‹ï¼Œçº¯ç²¹é ç¼–è¯‘å™¨æ‰“æ¡©çš„ä»£ç æ¥å®ç°åç¨‹è°ƒåº¦ã€‚å¦‚æœæ˜¯åé¢å‡ ç§å®ç°ï¼Œå°±è¦æ¨¡æ‹Ÿ**linux**çš„**clone**ç³»ç»Ÿè°ƒç”¨ï¼Œè¿™ä¸ªåé¢å†è¯´ã€‚
3. **é”ï¼Œ** è¿™é‡Œçš„é”ç‰¹æŒ‡**runtime**é‡Œé¢ä½¿ç”¨çš„**mutex**å’Œ**note**ä¸¤ç§å¾ˆé‡è¦çš„åŒæ­¥è®¾æ–½ï¼Œä¸»è¦ç”¨äºåŒæ­¥å¤šä¸ªMçš„ã€‚ä½†åœ¨**wasm**é‡Œé¢å› ä¸ºåªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œå› æ­¤**wasm**çš„çº¿ç¨‹ç›¸å…³å®ç°å‡ ä¹æ˜¯ç©ºæ“ä½œï¼ˆé™¤äº†notesleep)ï¼Œä½†Linuxé‡Œé¢å°±ç”¨çš„æ˜¯å®å®åœ¨åœ¨çš„**futex**å®ç°çš„ã€‚è¿˜æ˜¯çœ‹æˆ‘ä»¬çš„å®ç°ï¼Œç¬¬ä¸€ç§æ–¹å¼å°±å¯ä»¥å‚è€ƒ**wasm**çš„å®ç°(runtime/lock_js.go)ï¼Œå¦‚æœæ˜¯å¦‚æœæ˜¯åé¢å‡ ç§å®ç°ï¼Œå°±è¦æ¨¡æ‹Ÿlinuxçš„futexç³»ç»Ÿè°ƒç”¨ã€‚

å®ç°äº†ä¸Šé¢å‡ ä¸ªåŸºæœ¬åŠŸèƒ½ä¹‹åï¼Œå°±èƒ½å†™ä¸€äº›çº¯å†…å­˜æ“ä½œçš„Goç¨‹åºäº†ï¼Œgoroutineï¼Œchannelå•¥çš„éšä¾¿ç”¨ï¼Œä½†è¦æƒ³ä½¿ç”¨æ ‡å‡†åº“é‡Œé¢çš„æ–‡ä»¶ï¼Œç½‘ç»œç­‰åŠŸèƒ½è¿˜æ˜¯éœ€è¦åç»­çš„ä¸¤ä¸ªé‡è¦å·¥ä½œï¼Œ**ä¸­æ–­å’Œç³»ç»Ÿè°ƒç”¨**ã€‚

å¹³æ—¶æˆ‘ä»¬å†™Goç”¨æˆ·åº”ç”¨ç¨‹åºçš„æ—¶å€™æ˜¯ä¸å…³æ³¨ä¸­æ–­å’Œç³»ç»Ÿè°ƒç”¨è¿™äº›æ¦‚å¿µçš„ï¼Œå› ä¸ºGoçš„æ ‡å‡†åº“å¸®æˆ‘ä»¬å°è£…äº†è¿™äº›äº‹æƒ…ã€‚æ¯”å¦‚æˆ‘ä»¬å†™ä¸€ä¸ªç½‘ç»œç¨‹åºï¼Œåœ¨Goé‡Œé¢ç›´æ¥è°ƒç”¨net.Conn.Readé˜»å¡ç­‰å¾…æ•°æ®è¿”å›å°±å¯ä»¥äº†ï¼Œåœ¨æ²¡æœ‰æ•°æ®çš„æ—¶å€™ï¼Œgoçš„runtimeæŒ‚èµ·å½“å‰goroutineï¼ŒåŒæ—¶åœ¨runtimeå†…éƒ¨ä½¿ç”¨äº†epoll_waitç³»ç»Ÿè°ƒç”¨æ¥ç­‰å¾…fdçš„å¯è¯»äº‹ä»¶ã€‚åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ï¼Œæ”¶åˆ°epoll waitè°ƒç”¨åï¼Œæ“ä½œç³»ç»ŸæŒ‚èµ·å½“å‰ç­‰å¾…çš„çº¿ç¨‹ï¼Œè°ƒåº¦å…¶ä»–è¿›ç¨‹ã€‚ç­‰ç½‘å¡æ”¶åˆ°äº†æ•°æ®åŒ…çš„æ—¶å€™ï¼Œè§¦å‘äº†æ“ä½œç³»ç»Ÿçš„ç½‘ç»œä¸­æ–­ä¾‹ç¨‹ï¼Œç»è¿‡æ“ä½œç³»ç»Ÿçš„ç½‘ç»œæ ˆå¤„ç†åŸå§‹æ•°æ®åŒ…ä¹‹åï¼Œæ“ä½œç³»ç»Ÿåˆå”¤é†’äº†epoll waitçº¿ç¨‹ï¼Œå‘Šè¯‰å®ƒå“ªäº›fdå¯è¯»ï¼ŒGo runtimeè¿™ä¸ªæ—¶å€™å†å”¤é†’è°ƒç”¨Readçš„goroutineæ¥è¯»å–æ•°æ®ã€‚

ä¸Šé¢çš„æ•´ä¸ªè¿‡ç¨‹å¯¹æ™®é€šç”¨æˆ·æ˜¯é€æ˜çš„ï¼Œä½†æˆ‘ä»¬è¦è·‘åœ¨è£¸æœºä¸Šï¼Œä¸Šé¢çš„åº”ç”¨ç¨‹åºåˆ°ç¡¬ä»¶ä¹‹é—´çš„Gapå°±éœ€è¦æˆ‘ä»¬äº²è‡ªå»å¡«è¡¥äº†ã€‚å…³äºå¦‚ä½•å¤„ç†ä¸­æ–­å’Œç³»ç»Ÿè°ƒç”¨æœ¬èº«å°±å¯ä»¥å¦å¤–å†™ä¸€ç¯‡æ–‡ç« äº†ï¼Œè¿™é‡Œç®€å•è¯´ä¸€ä¸‹é‡åˆ°çš„éš¾ç‚¹ã€‚

å‰é¢è¯´è¿‡ï¼ŒGoé™¤äº†sysmonåç¨‹è¾…åŠ©è°ƒåº¦ä¹‹å¤–ï¼Œåœ¨å‡½æ•°å…¥å£ä»¥åŠç³»ç»Ÿè°ƒç”¨çš„åœ°æ–¹åŠ äº†ä¸€äº›æŒ‡ä»¤æ¥æ£€æŸ¥æ ˆæ˜¯å¦æº¢å‡ºï¼Œä»¥åŠæ˜¯å¦åº”è¯¥è°ƒåº¦å½“å‰åç¨‹ç­‰ã€‚è¿™äº›åœ¨ç”¨æˆ·ç¨‹åºé‡Œé¢æ²¡æœ‰é—®é¢˜ï¼Œä½†åœ¨å†…æ ¸ä»£ç é‡Œé¢ï¼Œè¿™äº›å°±å¾ˆè‡´å‘½äº†ï¼Œè¿™äº›æ£€æŸ¥ä»£ç ä¸€æ–¹é¢ä¼šå‡å®šå½“å‰æœ‰å¯ç”¨çš„Gæˆ–è€…Pï¼Œå¦ä¸€æ–¹é¢ä¼šå‘ç”Ÿæ½œåœ¨çš„åç¨‹è°ƒåº¦ï¼Œè€Œåœ¨ä¸­æ–­æˆ–è€…ç³»ç»Ÿè°ƒç”¨ä»£ç é‡Œé¢ï¼Œæ˜¯ä¸èƒ½å‡å®šæœ‰å¯ç”¨çš„Gæˆ–è€…Pçš„ï¼Œä¹Ÿä¸èƒ½å‘ç”Ÿè°ƒåº¦ï¼Œå¦‚ä½•å¤„ç†å¥½è¿™äº›é—®é¢˜çœŸçš„å¾ˆéš¾ã€‚å¥½æ¶ˆæ¯æ˜¯ï¼ŒGo runtimeä¹Ÿä¼šé‡åˆ°è¿™äº›é—®é¢˜ï¼Œå› æ­¤æˆ‘ä»¬æœ‰ç°æˆçš„ä»£ç å¯å€Ÿé‰´ï¼Œä½†åæ¶ˆæ¯æ˜¯ï¼Œå†™è¿™äº›ä»£ç çœŸçš„æ˜¯å¦‚å±¥è–„å†°ï¼Œä»»ä½•é«˜çº§çš„Go ç‰¹æ€§éƒ½ä¸èƒ½ä½¿ç”¨ï¼Œä¸€ç‚¹éƒ½ä¸æ¬¢ä¹ï¼Œå› æ­¤å¤§å®¶çœ‹åˆ°æˆ‘çš„è¿™ä¸ªé¡¹ç›®é‡Œé¢æ™¦æ¶©ä»£ç çš„æ—¶å€™ï¼Œå…¶å®å½“æ—¶å†™è¿™äº›ä»£ç çš„äººä¹Ÿå¾ˆæ— å¥ˆã€‚ç„¶è€Œè¿˜æœ‰å¦å¤–ä¸€ä¸ªå¥½æ¶ˆæ¯ï¼Œæˆ‘æŠŠè¿™äº›é—®é¢˜é€šè¿‡ç±»ä¼¼å¾®å†…æ ¸çš„æ€æƒ³ç»™è§£å†³äº†ï¼Œå…·ä½“å¯ä»¥çœ‹ä¸€ä¸‹æˆ‘çš„è¿™ä¸ªGoé¡¹ç›®çš„ä»£ç ã€‚

è¯´åˆ°è¿™é‡Œå°±ç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹æˆ‘å†™çš„è¿™ä¸ªé¡¹ç›®ã€‚æœ€æ—©æˆ‘èŒç”Ÿç¼–å†™å°†Goè·‘åœ¨è£¸æœºä¸Šçš„é¡¹ç›®æ˜¯è§‰å¾—Goçš„runtimeåšäº†å¾ˆå¤šç±»ä¼¼æ“ä½œç³»ç»Ÿçš„äº‹æƒ…ï¼Œæ¯”å¦‚goroutineå¯¹åº”è¿›ç¨‹ï¼Œchannelå¯¹åº”è¿›ç¨‹é—´é€šä¿¡ï¼ŒGoè¿˜æœ‰å®Œå–„çš„å†…å­˜ç®¡ç†ï¼Œå…³é”®æ˜¯Goç¼–è¯‘åæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶ï¼Œä¸éœ€è¦è™šæ‹Ÿæœºã€‚å› ä¸ºæˆ‘ä¸Šå­¦çš„æ—¶å€™ç”¨Cå†™è¿‡ä¸€ä¸ªminiOSï¼Œè§‰å¾—Goå¯èƒ½åšä¸€ä¸ªç®€å•çš„é€‚é…å±‚å°±å¯ä»¥è·‘åœ¨è£¸æœºä¸Šäº†ï¼Œè¯´å¹²å°±å¹²ï¼Œç–«æƒ…æœŸé—´æœ‰å¾ˆå¤šæ—¶é—´è®©æˆ‘å»æ€è€ƒå’Œå®éªŒè¿™ä¸ªæƒ³æ³•ï¼Œæœ€åè¿˜çœŸæˆåŠŸäº†ã€‚

[https://github.com/icexin/eggosgithub.com/icexin/eggos](https://link.zhihu.com/?target=https%3A//github.com/icexin/eggos)



## ç±»ä¼¼é¡¹ç›®

+ ç°ä»£æ“ä½œç³»ç»Ÿ

+ [æ¸…åå¤§å­¦rcoreé¡¹ç›®](http://rcore-os.cn/rCore-Tutorial-Book-v3/)

> ç”¨rustå®ç°æ“ä½œç³»ç»Ÿï¼Œè¿™ä¸ªé¡¹ç›®ç›®å‰ç¬¬ä¸‰ç‰ˆï¼Œå¾ˆæˆç†Ÿäº†ï¼Œæˆ‘å¾ˆå–œæ¬¢



## å¹¶è¡Œæˆ–åˆ†å¸ƒå¼ç®—æ³•

+ [x] [MIT6.824: Distributed System](https://pdos.csail.mit.edu/6.824/schedule.html)

### è¯¾ç¨‹ç®€ä»‹

+ æ‰€å±å¤§å­¦ï¼šMIT
+ å…ˆä¿®è¦æ±‚ï¼šè®¡ç®—æœºä½“ç³»ç»“æ„ï¼Œå¹¶è¡Œç¼–ç¨‹
+ ç¼–ç¨‹è¯­è¨€ï¼šGo
+ è¯¾ç¨‹éš¾åº¦ï¼šğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
+ é¢„è®¡å­¦æ—¶ï¼š200 å°æ—¶

è¿™é—¨è¯¾å’Œ MIT 6.S081 ä¸€æ ·ï¼Œå‡ºå“è‡ª MIT å¤§åé¼é¼çš„ PDOS å®éªŒå®¤ï¼Œæˆè¯¾è€å¸ˆ Robert Morris æ•™æˆæ›¾æ˜¯ä¸€ä½é¡¶å°–é»‘å®¢ï¼Œä¸–ç•Œä¸Šç¬¬ä¸€ä¸ªè •è™«ç—…æ¯’ Morris ç—…æ¯’å°±æ˜¯å‡ºè‡ªä»–ä¹‹æ‰‹ã€‚

è¿™é—¨è¯¾æ¯èŠ‚è¯¾éƒ½ä¼šç²¾è¯»ä¸€ç¯‡åˆ†å¸ƒå¼ç³»ç»Ÿé¢†åŸŸçš„ç»å…¸è®ºæ–‡ï¼Œå¹¶ç”±æ­¤ä¼ æˆåˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡ä¸å®ç°çš„é‡è¦åŸåˆ™å’Œå…³é”®æŠ€æœ¯ã€‚åŒæ—¶å…¶è¯¾ç¨‹ Project ä¹Ÿæ˜¯ä»¥å…¶éš¾åº¦ä¹‹å¤§è€Œé—»åéè¿©ï¼Œ4 ä¸ªç¼–ç¨‹ä½œä¸šå¾ªåºæ¸è¿›å¸¦ä½ å®ç°ä¸€ä¸ªåŸºäº Raft å…±è¯†ç®—æ³•çš„ KV-store æ¡†æ¶ï¼Œè®©ä½ åœ¨ç—›è‹¦çš„ debug ä¸­ä½“ä¼šå¹¶è¡Œä¸åˆ†å¸ƒå¼å¸¦æ¥çš„éšæœºæ€§å’Œå¤æ‚æ€§ã€‚

åŒæ ·ï¼Œè¿™é—¨è¯¾ç”±äºå¤ªè¿‡å‡ºåï¼Œç½‘ä¸Šç­”æ¡ˆæ— æ•°ï¼Œå¸Œæœ›å¤§å®¶ä¸è¦å‚è€ƒï¼Œè€Œæ˜¯åŠ›å›¾è‡ªä¸»å®ç°æ•´ä¸ª Projectã€‚



### è¯¾ç¨‹èµ„æº

+ è¯¾ç¨‹ç½‘ç«™ï¼šhttps://pdos.csail.mit.edu/6.824/schedule.html
+ è¯¾ç¨‹è§†é¢‘ï¼šå‚è§è¯¾ç¨‹ç½‘ç«™é“¾æ¥
+ è¯¾ç¨‹æ•™æï¼šæ— ï¼Œä»¥é˜…è¯»è®ºæ–‡ä¸ºä¸»
+ è¯¾ç¨‹ä½œä¸šï¼š4 ä¸ªéå¸¸è™çš„ Projectï¼Œå…·ä½“è¦æ±‚å‚è§è¯¾ç¨‹ç½‘ç«™

> [æ”¶é›†çš„ä¸€äº›æ–‡æ¡£](https://mit-public-courses-cn-translatio.gitbook.io/mit6-824/)



### èµ„æºæ±‡æ€»

@PKUFlyingPig åœ¨å­¦ä¹ è¿™é—¨è¯¾ä¸­ç”¨åˆ°çš„æ‰€æœ‰èµ„æºå’Œä½œä¸šå®ç°éƒ½æ±‡æ€»åœ¨ [PKUFlyingPig/MIT6.824 - GitHub](https://github.com/PKUFlyingPig/MIT6.824) ä¸­ã€‚

@[OneSizeFitsQuorum](https://github.com/OneSizeFitsQuorum) çš„ [Lab æ–‡æ¡£](https://github.com/OneSizeFitsQuorum/MIT6.824-2021) è¾ƒä¸ºæ¸…æ™°åœ°ä»‹ç»äº†å®ç° lab 1-4 å’Œ challenge 1-2 æ—¶éœ€è¦è€ƒè™‘çš„è®¸å¤šç»†èŠ‚ï¼Œåœ¨é‡åˆ°ç“¶é¢ˆæœŸæ—¶å¯ä»¥é˜…è¯»ä¸€ä¸‹~~


## License
[![FOSSA Status](https://app.fossa.com/api/projects/git%2Bgithub.com%2F3293172751%2Fcubgo-os.svg?type=large)](https://app.fossa.com/projects/git%2Bgithub.com%2F3293172751%2Fcubgo-os?ref=badge_large)